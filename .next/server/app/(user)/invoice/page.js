(()=>{var e={};e.id=304,e.ids=[304],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},81092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(69355),r(35866),r(68295);var s=r(23191),o=r(88716),i=r(37922),n=r.n(i),a=r(95231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let d=["",{children:["(user)",{children:["invoice",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,69355)),"C:\\Users\\dell\\Desktop\\Next_Resort\\resort_booking\\src\\app\\(user)\\invoice\\page.jsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,68295)),"C:\\Users\\dell\\Desktop\\Next_Resort\\resort_booking\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\dell\\Desktop\\Next_Resort\\resort_booking\\src\\app\\(user)\\invoice\\page.jsx"],u="/(user)/invoice/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/(user)/invoice/page",pathname:"/invoice",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},24125:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},83048:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,79404,23)),Promise.resolve().then(r.bind(r,48273))},77358:()=>{},48273:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var s=r(10326),o=r(17577);let i=({userId:e})=>{let[t,r]=(0,o.useState)(null),[i,n]=(0,o.useState)(!0),[a,l]=(0,o.useState)(null);console.log("extractId:",e);let d=async()=>{try{let t=await fetch(`https://next-resort-project.vercel.app/api/users/${e}`),s=await t.json();if(console.log("newData:",s),t.ok)r(s.data);else throw Error(s.message||"Failed to fetch invoice data")}catch(e){l(e.message),console.log(e)}finally{n(!1)}};if((0,o.useEffect)(()=>{d()},[]),i)return s.jsx("div",{children:"Loading..."});if(a)return(0,s.jsxs)("div",{children:["Error: ",a]});if(!t||!t.bookings)return s.jsx("div",{children:"No invoice data available"});let c=(e,t)=>{let r=new Date(e);return Math.ceil(Math.abs(new Date(t)-r)/864e5)},u=async e=>{if(window.confirm("Are you sure to delete this booking?"))try{let t=await fetch(`https://next-resort-project.vercel.app/api/users/${e}`,{method:"DELETE"}),s=await t.json();if(t.ok)r(t=>({...t,bookings:t.bookings.filter(t=>t._id!==e)})),console.log("Booking deleted:",s);else throw Error(s.message||"Failed to delete booking")}catch(e){console.error("Error deleting booking:",e),alert("Failed to delete booking")}};return(0,s.jsxs)("div",{className:"invoice-container",children:[(0,s.jsxs)("h1",{children:["Username: ",t.username]}),t.bookings.length>0?t.bookings.map(e=>{let t=c(e.startDate,e.endDate),r=t*e.price;return(0,s.jsxs)("div",{className:"booking-item",children:[s.jsx("h3",{children:e.productName}),(0,s.jsxs)("p",{children:["Booking dates from ",e.startDate," to ",e.endDate]}),(0,s.jsxs)("p",{children:["Discount: ",e.offer,"%"]}),(0,s.jsxs)("p",{children:["Number of Days: ",t]}),(0,s.jsxs)("h4",{children:["Price per day: ",e.price]}),(0,s.jsxs)("h4",{children:["Total Amount: ",r]}),s.jsx("div",{align:"center",children:s.jsx("button",{onClick:()=>u(e._id),className:"deleteBtn",children:"Delete Booking"})})]},e._id)}):s.jsx("div",{className:"no-bookings",children:"No bookings available"})]})}},57371:(e,t,r)=>{"use strict";r.d(t,{default:()=>o.a});var s=r(670),o=r.n(s)},670:(e,t,r)=>{"use strict";let{createProxy:s}=r(68570);e.exports=s("C:\\Users\\dell\\Desktop\\Next_Resort\\resort_booking\\node_modules\\next\\dist\\client\\link.js")},69355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(19510),o=r(59364),i=r(68570);let n=(0,i.createProxy)(String.raw`C:\Users\dell\Desktop\Next_Resort\resort_booking\src\app\components\UserInvoice.jsx`),{__esModule:a,$$typeof:l}=n;n.default;let d=(0,i.createProxy)(String.raw`C:\Users\dell\Desktop\Next_Resort\resort_booking\src\app\components\UserInvoice.jsx#default`);var c=r(6037),u=r(30728);r(71159);let p=async()=>{let e=await (0,o.I8)(),t=e.email,r=await u.Z.findOne({email:t}),i=r?._id.toString(),n=r?.bookings.length||0;return console.log("userId:",i),(0,s.jsxs)("div",{children:[s.jsx(c.Z,{userName:e.username,bookingCount:n}),s.jsx(d,{userId:i})]})}},59364:(e,t,r)=>{"use strict";r.d(t,{HT:()=>d,I8:()=>n,a4:()=>c});var s=r(152),o=r(80772),i=r(30728);let{auth:n,signIn:a,signOut:l,handlers:{GET:d,POST:c}}=(0,s.ZP)({providers:[(0,o.Z)({name:"credentials",async authorize(e){let t=await i.Z.findOne({email:e?.email});return t&&e?.password===t.password?{name:t.username,email:t.email,role:t.role}:null}})],secret:process.env.SECRET_KEY,callbacks:{jwt:async({token:e,user:t})=>(t&&(e.userId=t.id,e.username=t.name,e.role=t.role,e.email=t.email),e),session:async({session:e,token:t})=>(e.userId=t.userId,e.username=t.username,e.role=t.role,e.email=t.email,e)}})},6037:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var s=r(19510),o=r(57371);r(71159);let i=({userName:e})=>(0,s.jsxs)("div",{className:"navSection",children:[s.jsx("div",{className:"title",children:s.jsx(o.default,{href:"/",className:"link",children:s.jsx("h2",{children:"Holiday Resort"})})}),s.jsx("div",{className:"contact",children:"Call now : 123 456 789"}),s.jsx(o.default,{href:"/invoice",className:"link",children:s.jsx("div",{className:"bookings",children:"Bookings:"})}),(0,s.jsxs)("p",{children:["Welcome:",s.jsx("span",{style:{color:"yellow",marginLeft:"5px",fontSize:"1.2rem",border:"none"},children:e})]}),s.jsx(o.default,{href:"/api/auth/signout",className:"link",children:s.jsx("div",{className:"logout",children:"Logout"})})]})},68295:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a,metadata:()=>n});var s=r(19510),o=r(1723),i=r.n(o);r(5023);let n={title:"Create Next App",description:"Generated by create next app"};function a({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:i().className,children:e})})}},30728:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let{default:s,mongo:o}=r(11185),i=new s.Schema({username:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,default:"user"},bookings:[{type:s.Schema.Types.ObjectId,ref:"booking"}]}),n=s.models.user||s.model("user",i)},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(66621);let o=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,70,462,838,431],()=>r(81092));module.exports=s})();